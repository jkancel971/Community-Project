<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <title>Community-Project</title>

  <!-- CSS  -->
  <link href="./service_files/icon" rel="stylesheet">
  <link href="./service_files/materialize.css" type="text/css" rel="stylesheet" media="screen,projection">
  <link href="./service_files/style.css" type="text/css" rel="stylesheet" media="screen,projection">
  <style>
	#map {
	width: 400px;
	height: 300px;
	background-color: grey;
	}
</style>
</head>
<body>
<nav>
    <div class="nav-wrapper teal lighten-2">
      <a href="#!" class="brand-logo">&nbsp;&nbsp;&nbsp;&nbsp;Community Project</a>
      <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
      <ul class="right hide-on-med-and-down">
        <li><a href="acceuilConnecte.html">Accueil</a></li>
        <li><a href="demandeService.html">Demander un service</a></li>
        <li><a href="listeService.html">Proposer de l'aide</a></li>
        <li><a href="listeCommunaute.html">Communautés</a></li>
        <li><a href="profil.html">Profil</a></li>
        <li><a onclick="disconnect()">Déconnexion</a></li>
      </ul>
      <ul class="side-nav" id="mobile-demo">
        <li><a href="acceuilConnecte.html">Accueil</a></li>
        <li><a href="demandeService.html">Demander un service</a></li>
        <li><a href="listeService.html">Proposer de l'aide</a></li>
        <li><a href="listeCommunaute.html">Communautés</a></li>
        <li><a href="profil.html">Profil</a></li>
        <li><a onclick="disconnect()">Déconnexion</a></li>
      </ul>
    </div>
  </nav>
	<div id="connexion" class="modal">
    <div class="modal-content">
      <h4>Connectez-vous</h4>
       <div class="row">
               <div class="input-field col s6">
                    <i class="material-icons prefix">email</i>
                    <input id="email" type="email" class="validate">
                    <label for="email" data-error="adresse mail invalide" data-success="">Email</label>
               </div>
               <div class="input-field col s6">
                    <i class="material-icons prefix">lock</i>
			              <input id="password" type="password" class="validate">
                    <label for="password">Mot de passe</label>
               </div>
            </div>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Annuler</a>
      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Valider</a>
    </div>
  </div>
  <div class="parallax-container valign-wrapper">
    <div class="section no-pad-bot">
      <div class="container">
        <div class="row center">
          <h2 class="header center white-text text-accent-3" style="text-shadow: #000000 1px 1px, #000000 -1px 1px, #000000 -1px -1px, #000000 1px -1px;">Proposez votre aide pour un service</h2>
        </div>
      </div>
    </div>
    <div class="parallax"><img src="backgrounds/background7.jpg" alt="Unsplashed background img 2"></div>
  </div>
  <div class="row center">
    <h3 class="teal-text text-lighten-2"> Description du service</h3>
  </div> 
	<div class="row">
        <div class="col s2"></div>
        <div class="input-field col s4">
          <i class="tiny material-icons">edit</i> Titre:
           <p><label id="titre_label">Exemple de titre de service</label></p>				
        </div>
        <div class="input-field col s3">
          <i class="tiny material-icons">contacts</i> Demandé par :
          <P><label id="demandeur_label">Jean Dujardin</label></p>					
        </div>

        <div class="input-field col s3">
          <i class="tiny material-icons">today</i> Date:
          <P><label id="date_demande_label">14/05/2017 16h00</label></p>					
        </div>
	</div>
  <div class="row">
    <div class="col s2"></div>
    <div class="input-field col s4">
      <i class="tiny material-icons">store</i> Communauté
      <p><label id="communaute_label">Nom de la communauté</label></p>
    </div>
    <div class="input-field col s3">Date de création
				<p><label id="date_creation_label">04/04/2017</label></p>					
			</div>
			<div class="input-field col s3">Statut
				<p><label id="status_label">En cours de recherche</label></p>					
			</div>
  </div>
  <div class="row">
    <div class="col s2"></div>
    <div class="input-field col s7">
      <i class="tiny material-icons">room</i> Adresse
      <p><label id="adresse_label">128 boulevard du 11 novembre 1918 Immeuble La Doua 69100 Villeurbanne</label></p>
    </div>
    <div class="input-field col s3">
      <i class="tiny material-icons">stars</i> Nombre de jetons:
      <p><label id="status_label">2</label></p>					
    </div>
  </div>
  <div class="row">
    <div class="col s2"></div>
    <div class="input-field col s8">                 
                 <div id="map"></div>
                    <script>
                            var map;
                            function initMap() {
                            var location = {lat: 45.756284, lng: 4.850491};
                            map = new google.maps.Map(document.getElementById('map'), {
                            zoom: 12,
                            center: location
                            });
                            var marker = new google.maps.Marker({
                            position: location,
                            map: map
                            });
                        }
                    </script>
                    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAt5hKjmRs37vSRzlEqbCtohxdaDDs9FQ4&callback=initMap"></script>			
		    </div>
        <div class="col s2"></div>
  </div>
  <div class="row center">
    <div class="col s2"></div>
    <div class="input-field col s8">Description
      <p><label id="description_label">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam scelerisque id nunc nec volutpat. Etiam pellentesque tristique arcu, non consequat magna fermentum ac. Cras ut ultricies eros. Maecenas eros justo, ullamcorper a sapien id, viverra ultrices eros. Morbi sem neque, posuere et pretium eget, bibendum sollicitudin lacus. Aliquam eleifend sollicitudin diam, eu mattis nisl maximus sed. Nulla imperdiet semper molestie. Morbi massa odio, condimentum sed ipsum ac, gravida ultrices erat. Nullam eget dignissim mauris, non tristique erat. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae;</label></p>
    </div>
    <div class="col s2"></div>
  </div>
  <br/><br/><br/><br/><br/><br/><br/><br/>
	<div class="row center">
			<a id="postuler_button" class="waves-effect waves-light btn">Postuler pour ce service!</a>				
	</div>
	<div class="row">
      <div class="col s2"></div>
      <div class="col s4">Postulants
        <ul class="collection">
          <li class="collection-item avatar">
            <img src="images/membre1.jpg" alt="" class="circle">
            <span class="title">Alan</span>
            <p>4 services effectués
            </p>
          </li>
          <li class="collection-item avatar">
            <img src="images/membre2.jpg" alt="" class="circle">
            <span class="title">Louis</span>
            <p>6 services effectués
            </p>
          </li>
        </ul>
		</div>
      <div class="col s4">Questions/Réponses
			<ul class="collection">
				<li class="collection-item avatar">
				<img src="images/membre1.jpg" alt="" class="circle">
				<span class="title">Alan</span>
				<p>12/04/2017 - 10h00<br>
				Bonjour ! Est il possible de faire le travail à 16h au lieu de 14h?
				</p>

				<li class="collection-item avatar">
				<img src="images/membre3.jpg" alt="" class="circle">
				<span class="title">Justin</span>
				<p>12/04/2017 - 14h30
				<br>
				Bonjour ! hmm, oui c'est possible
				</p>
				</li>
			
				<li class="collection-item avatar">
				<img src="images/membre1.jpg" alt="" class="circle">
				<span class="title">Alan</span>
				<p>12/04/2017 - 20h00<br>
				Merci. Je vais postuler tout de suite
				</p>
				</li>
			</ul>
      <div class="col s2"></div>
		<div class="row">
		
	  </div>
	  </div>
	  </div>

    <div class="parallax-container valign-wrapper">
    <div class="section no-pad-bot">
      <div class="container">
        <div class="row center">
          <h4 class=" col s12 light white-text text-lighten-2" style="text-shadow: #000000 1px 1px, #000000 -1px 1px, #000000 -1px -1px, #000000 1px -1px;">Bricolage // Jardinage // Education // Informatique // Réparations // Et bien plus encore...</h4>
        </div>
      </div>
    </div>
    <div class="parallax"><img src="backgrounds/background9.jpg" alt="Unsplashed background img 2"></div>
  </div>

  <footer class="page-footer teal">
    <div class="container">
      <div class="row center">
        <div class="col s12">
          <h5 class="white-text">Qui sommes nous?</h5>
          <p class="grey-text text-lighten-4">Une équipe formée par des élèves ingénieurs et le Grand Lyon. Notre but commun: permettre l'amélioration de la vie communautaire dans Lyon, et veiller au bien-être de ses citoyens. Nous encourageons le partage, l'entraide, et la bienveillance.</p>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container">
      Réalisé par des élèves de l'<a class="brown-text text-lighten-3" href="https://www.insa-lyon.fr/">INSA Lyon</a>
      </div>
    </div>
  </footer>


  <!--  Scripts-->
  <script src="./service_files/jquery-2.1.1.min.js.download"></script>
  <script src="./service_files/materialize.js.download"></script>
  <script src="./service_files/init.js.download"></script>
	<script>
  $(document).ready(function(){
    // the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
    $('.modal').modal();
  });
  </script>

<script>
    function preloadFunc() {
        $.ajax({
            url : './MainServlet',
            type : 'POST',
            dataType : 'json',
            data: { action: "check_permission",},
            success : function(data){
                if(data.response == "401")
                    document.location.href="needConnection.html";
            },
            error: function (jqXHR, textStatus, errorThrown) {
                // alert(jqXHR + " | " +textStatus + " | " +errorThrown);
            }
        });
    }
    window.onpaint = preloadFunc();
  </script>
  
<script>
function GetURLParameter(sParam)
	{

	    var sPageURL = window.location.search.substring(1);

	    var sURLVariables = sPageURL.split('&');

	    for (var i = 0; i < sURLVariables.length; i++)

	    {

	        var sParameterName = sURLVariables[i].split('=');

	        if (sParameterName[0] == sParam)

	        {

	            return sParameterName[1];

	        }

	    }

	};
  </script> 
  
<script>
 $(document).ready(function(){    
    var marker;//google maps
    $.ajax({
            url : './MainServlet',
            type : 'POST',
            dataType : 'json',
            data: { action: "init_service",
                    id: GetURLParameter('id')},
            success : function(data){
                if(data.response == "403"){
                    $('#error_service').show();
                }
                else{
                    $("#titre_label").html(data.titre);
                    $("#demandeur_label").html(data.demandeur);
                    $("#date_demande_label").html(data.date_realisation);
                    $("#jetons_label").html(data.jetons);
                    $("#communaute_label").html(data.communaute);
                    $("#date_creation_label").html(data.date_demande);
                    $("#status_label").html(data.status);
                    $("#adresse_label").html(data.adresse).append(" "+data.ville).append(" "+data.CP);
                    $("#description_label").html(data.description);
                    
                    /*
                    geocoder = new google.maps.Geocoder();


                    var address = $("#adresse_label").value;
                    var titre = $("#titre_label").value;

                    geocoder.geocode( { 'address' : address }, function( results, status ) {
                        if( status == google.maps.GeocoderStatus.OK ) {
                            map.setCenter( results[0].geometry.location );
                            marker = new google.maps.Marker( {
                               map     : map,
                               position: results[0].geometry.location,
                               title : titre
                            });
                        }else{
                            alert( 'Geocode was not successful for the following reason: ' + status );
                        }
                    });*/
                }
  
            },
            error: function (jqXHR, textStatus, errorThrown) {
                // alert(jqXHR + " | " +textStatus + " | " +errorThrown);
            },
            complete: function (jqXHR, textStatus ) {
                //Redirection
            }
        })
    });
  </script>
  
  <script>
$(document).ready(function(){
        $('#postuler_button').click(function(){
		$.ajax({
			url : './MainServlet',
			type : 'POST',
			dataType : 'json',
			data: { action: "postuler",
                                id: GetURLParameter('id')
                              },
			success : function(data){
                            if(data.response == "200"){
                                document.location.href="servicePostule.html";
                            }else{
                                alert("erreur!");
                            }
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            // alert(jqXHR + " | " +textStatus + " | " +errorThrown);
                        }
		});
	});
    });
  </script>
  
  <script>
    function disconnect() {
        $.ajax({
            url : './MainServlet',
            type : 'POST',
            dataType : 'json',
            data: { action: "disconnect",},
            success : function(data){
                if(data.response == "200")
                    document.location.href="index.html";
            },
            error: function (jqXHR, textStatus, errorThrown) {
                // alert(jqXHR + " | " +textStatus + " | " +errorThrown);
            }
        });
    }
  </script>
  
  <style>
	#map {
	width: 100%;
	height: 200px;
	background-color: grey;
	}
</style>
<div class="hiddendiv common"></div><div class="drag-target" data-sidenav="mobile-demo" style="left: 0px; touch-action: pan-y; -webkit-user-drag: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></div></body></html>