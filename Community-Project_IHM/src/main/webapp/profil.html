<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
  <title>Community-Project</title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
</head>
<body>
  <nav>
    <div class="nav-wrapper teal lighten-2">
      <a href="#!" class="brand-logo">&nbsp;&nbsp;&nbsp;&nbsp;Community Project</a>
      <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
      <ul class="right hide-on-med-and-down">
        <li><a href="acceuilConnecte.html">Accueil</a></li>
        <li><a href="demandeService.html">Demander un service</a></li>
        <li><a href="listeService.html">Proposer de l'aide</a></li>
        <li><a href="listeCommunaute.html">Communautés</a></li>
        <li><a href="profil.html">Profil</a></li>
        <li><a onclick="disconnect()">Déconnexion</a></li>
      </ul>
      <ul class="side-nav" id="mobile-demo">
        <li><a href="acceuilConnecte.html">Accueil</a></li>
        <li><a href="demandeService.html">Demander un service</a></li>
        <li><a href="listeService.html">Proposer de l'aide</a></li>
        <li><a href="listeCommunaute.html">Communautés</a></li>
        <li><a href="profil.html">Profil</a></li>
        <li><a onclick="disconnect()">Déconnexion</a></li>
      </ul>
    </div>
  </nav>
  <div class="parallax-container valign-wrapper">
    <div class="section no-pad-bot">
      <div class="container">
        <h2 id="bonjour" class="header center white-text text-accent-3" style="text-shadow: #000000 1px 1px, #000000 -1px 1px, #000000 -1px -1px, #000000 1px -1px;">Bonjour</h2>
        <h4 class="header center col s12 bold" style="text-shadow: #000000 1px 1px, #000000 -1px 1px, #000000 -1px -1px, #000000 1px -1px;">Consultez et modifiez votre profil</h4>
      </div>
    </div>
    <div class="parallax"><img src="backgrounds/background9.jpg" alt="Unsplashed background img 1"></div>
  </div>
    <br/>
    
  <div class="container">
    <div class="section">
      <div class="row center">
        <h3 class="teal-text text-lighten-2"> Profil</h3>
      </div>
       <div class="row">
         <form class="col s12">
            <div class="row">
                <div class="input-field col s2">
                     <img class="circle responsive-img" src="backgrounds/person1.png">
               </div>
               <div class="input-field col s10">
                   <div class="row">
                     <br/><br/>
                        <div class="input-field col s6">
                                <i class="material-icons prefix">person_pin</i>
                                <label  id ="prenom" class="black-text">Prénom</label>
                        </div>
                        <div class="input-field col s6">
                                <i class="material-icons prefix">phone</i>
                                <label  id ="phone" class="black-text">Téléphone</label>
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="input-field col s6">
                            <i class="material-icons prefix">email</i>
                            <label  id ="mail" class="black-text">adresse@example.com</label>
                        </div>
                        <div class="input-field col s6">
                            <i class="material-icons prefix">room</i>
                            <label  id ="adresse" class="black-text">Exemple adresse</label>
                        </div>
                   </div>
                   <br/>
                   <div class="row">
                        <div class="input-field col s10">
                          <br/><br/>
                            <div id="map"></div>
                                <script>
                                    function initMap() {
                                        var location = {lat: 45.756284, lng: 4.850491};
                                        var map = new google.maps.Map(document.getElementById('map'), {
                                        zoom: 12,
                                        center: location
                                        });
                                        var marker = new google.maps.Marker({
                                        position: location,
                                        map: map
                                        });
                                    }
                                </script>
                                <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAt5hKjmRs37vSRzlEqbCtohxdaDDs9FQ4&callback=initMap"></script>			
                        </div>
                        </div>
                   </div>
               </div>      
            </div>
         </form>       
      </div>
      <div class="row center">
          <a href="modificationProfil.html" id="modifier_profil" class="btn-large waves-effect waves-light teal lighten-1">Modifier mon profil</a>
      </div>
    </div>
  </div>
  <hr/>
  <div class="container">
    <div class="section">
      <div class="row center">
        <h3 class="teal-text text-lighten-2"> Communautés</h3>
      </div>
      <div class="row">
              <div class="col s6"> Communautés:     
                  <label  id ="comm1"></label>
                    <ul class="collection">
                        <font color="teal"><li class="collection-item"><a href="communaute.html" class="secondary-content"><i class="small material-icons">search</i></a>
                        AS Insa Lyon<br/></font>
                        <font color="red"> <i class="tiny material-icons">stars</i> Total jetons: 2</font>
                        </li>
                        <font color="teal"><li class="collection-item"><a href="communaute.html" class="secondary-content"><i class="small material-icons">search</i></a>
                        Centre Bayard<br/></font>
                        <font color="red"> <i class="tiny material-icons">stars</i> Total jetons: 2</font>
                        </li>
                        <font color="teal"><li class="collection-item"><a href="communaute.html" class="secondary-content"><i class="small material-icons">search</i></a>
                        Immeuble La Doua<br/></font>
                        <font color="red"> <i class="tiny material-icons">stars</i> Total jetons: 2</font>
                        </li>
                    </ul>
              </div>
              <div class="col s6">  Communautés créées:
                  <label  id ="comm2"></label>    
                    <ul class="collection">
                        <font color="teal"><li class="collection-item"><a href="communaute.html" class="secondary-content"><i class="small material-icons">mode_edit</i></a>
                        AS Insa Lyon<br/></font>
                        <font color="red"> <i class="tiny material-icons">stars</i> Total jetons: 2</font>
                        </li>
                        <font color="teal"><li class="collection-item"><a href="communaute.html" class="secondary-content"><i class="small material-icons">mode_edit</i></a>
                        Centre Bayard<br/></font>
                        <font color="red"> <i class="tiny material-icons">stars</i> Total jetons: 2</font>
                        </li>
                    </ul>
              </div>
          </div>
        </div>
      </div>

  <hr/>
  <div class="container">
    <div class="section">
      <div class="row center">
        <h3 class="teal-text text-lighten-2"> Services</h3>
      </div>
        <div class="row">
            <div class="col s3"></div>
            <div class="col s6"> Services à venir (2)
                <ul class="collection">
                  <li class="collection-item avatar">
                    <a href="service.html" class="collection-item black-text">Titre: Nettoyage de mon jardin<br/>
                    <img src="categories/jardinage.jpg" alt="" class="circle">
                    Catégorie: Jardinage<br/>
                    <p>Demandeur : Valérie
                    </p>
                    <i class="tiny material-icons">today</i>Date: 10/05/2017  | 
                    <i class="tiny material-icons">stars</i> Jetons offerts: 2  | 
                    <i class="tiny material-icons">perm_identity</i> Nombre de personnes: 1</a>
                  </li>
                  <li class="collection-item avatar">
                    <a href="service.html" class="collection-item black-text">Titre: Fabrication et pose de coffrages en bois<br/>
                    <img src="categories/bricolage.jpg" alt="" class="circle">Catégorie: Bricolage<br/>
                    <p>Demandeur : Arthur
                    </p>
                    <i class="tiny material-icons">today</i>Date: 13/05/2017  | 
                    <i class="tiny material-icons">stars</i> Jetons offerts: 3  | 
                    <i class="tiny material-icons">perm_identity</i> Nombre de personnes: 2</a>
                  </li>
                </ul>
            </div>
            <div class="col s3"></div>
        </div>
  </div>
</div>
<div class="row">
           <div class="col s4">  Services rendus(2):    
               <ul class="collection">
                  <li class="collection-item avatar">
                    <a href="service.html" class="collection-item black-text">Titre: Nettoyage de mon jardin<br/>
                    <img src="categories/jardinage.jpg" alt="" class="circle">
                    Catégorie: Jardinage<br/>
                    <p>Demandeur : Valérie
                    </p>
                    <i class="tiny material-icons">today</i>Date: 10/05/2017  | 
                    <i class="tiny material-icons">stars</i> Jetons offerts: 2  | 
                    <i class="tiny material-icons">perm_identity</i> Nombre de personnes: 1</a>
                  </li>
                  <li class="collection-item avatar">
                    <a href="service.html" class="collection-item black-text">Titre: Fabrication et pose de coffrages en bois<br/>
                    <img src="categories/bricolage.jpg" alt="" class="circle">Catégorie: Bricolage<br/>
                    <p>Demandeur : Arthur
                    </p>
                    <i class="tiny material-icons">today</i>Date: 13/05/2017  | 
                    <i class="tiny material-icons">stars</i> Jetons offerts: 3  | 
                    <i class="tiny material-icons">perm_identity</i> Nombre de personnes: 2</a>
                  </li>
                </ul>
           </div>
           <div class="col s4">  Services demandés (2):
               <ul class="collection">
                  <li class="collection-item avatar">
                    <a href="service.html" class="collection-item black-text">Titre: Nettoyage de mon jardin<br/>
                    <img src="categories/jardinage.jpg" alt="" class="circle">
                    Catégorie: Jardinage<br/>
                    <p>Demandeur : Valérie
                    </p>
                    <i class="tiny material-icons">today</i>Date: 10/05/2017  | 
                    <i class="tiny material-icons">stars</i> Jetons offerts: 2  | 
                    <i class="tiny material-icons">perm_identity</i> Nombre de personnes: 1</a>
                  </li>
                  <li class="collection-item avatar">
                    <a href="service.html" class="collection-item black-text">Titre: Fabrication et pose de coffrages en bois<br/>
                    <img src="categories/bricolage.jpg" alt="" class="circle">Catégorie: Bricolage<br/>
                    <p>Demandeur : Arthur
                    </p>
                    <i class="tiny material-icons">today</i>Date: 13/05/2017  | 
                    <i class="tiny material-icons">stars</i> Jetons offerts: 3  | 
                    <i class="tiny material-icons">perm_identity</i> Nombre de personnes: 2</a>
                  </li>
                </ul>
           </div>
           <div class="col s4">   Services postulés (1):   
               <ul class="collection">
                  <li class="collection-item avatar">
                    <a href="service.html" class="collection-item black-text">Titre: Nettoyage de mon jardin<br/>
                    <img src="categories/jardinage.jpg" alt="" class="circle">
                    Catégorie: Jardinage<br/>
                    <p>Demandeur : Valérie
                    </p>
                    <i class="tiny material-icons">today</i>Date: 10/05/2017  | 
                    <i class="tiny material-icons">stars</i> Jetons offerts: 2  | 
                    <i class="tiny material-icons">perm_identity</i> Nombre de personnes: 1</a>
                  </li>
                </ul>
           </div>
          </div>
    </div>


  <div class="parallax-container valign-wrapper">
    <div class="section no-pad-bot">
      <div class="container">
        <div class="row center">
          <h4 class=" col s12 light white-text text-lighten-2" style="text-shadow: #000000 1px 1px, #000000 -1px 1px, #000000 -1px -1px, #000000 1px -1px;">Bricolage // Jardinage // Education // Informatique // Réparations // Et bien plus encore...</h4>
        </div>
      </div>
    </div>
    <div class="parallax"><img src="backgrounds/background7.jpg" alt="Unsplashed background img 2"></div>
  </div>

  <footer class="page-footer teal">
    <div class="container">
      <div class="row center">
        <div class="col s12">
          <h5 class="white-text">Qui sommes nous?</h5>
          <p class="grey-text text-lighten-4">Une équipe formée par des élèves ingénieurs et le Grand Lyon. Notre but commun: permettre l'amélioration de la vie communautaire dans Lyon, et veiller au bien-être de ses citoyens. Nous encourageons le partage, l'entraide, et la bienveillance.</p>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container">
      Réalisé par des élèves de l'<a class="brown-text text-lighten-3" href="https://www.insa-lyon.fr/">INSA Lyon</a>
      </div>
    </div>
  </footer>


  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>
  <script src="js/init.js"></script>
  
 <script>
    function preloadFunc() {
        $.ajax({
            url : './MainServlet',
            type : 'POST',
            dataType : 'json',
            data: { action: "check_permission",},
            success : function(data){
                if(data.response == "401")
                    document.location.href="needConnection.html";
            },
            error: function (jqXHR, textStatus, errorThrown) {
                // alert(jqXHR + " | " +textStatus + " | " +errorThrown);
            }
        });
    }
    window.onpaint = preloadFunc();
  </script>
  
  <script>
 $(document).ready(function(){    
    
    $.ajax({
            url : './MainServlet',
            type : 'POST',
            dataType : 'json',
            data: { action: "init_profil"
                   },
            success : function(data){
                if(data.response == "403"){
                    $('#error_service').show();
                }
                else{
                    $("#prenom").html(data.nom).append(" "+data.prenom);
                    $("#mail").html(data.mail);
                    //$("#phone").html(data.dat);
                    $("#adresse").html(data.adresse).append(", "+data.ville).append(" "+data.cp);
                    $("#bonjour").html("Bonjour, "+data.nom+" "+data.prenom);

                }
  
            },
            error: function (jqXHR, textStatus, errorThrown) {
                // alert(jqXHR + " | " +textStatus + " | " +errorThrown);
            },
            complete: function (jqXHR, textStatus ) {
                //Redirection
            }
        })
    });
  </script>
  
  <script>
    function disconnect() {
        $.ajax({
            url : './MainServlet',
            type : 'POST',
            dataType : 'json',
            data: { action: "disconnect",},
            success : function(data){
                if(data.response == "200")
                    document.location.href="index.html";
            },
            error: function (jqXHR, textStatus, errorThrown) {
                // alert(jqXHR + " | " +textStatus + " | " +errorThrown);
            }
        });
    }
  </script>
  <style>
	#map {
	width: 100%;
	height: 200px;
	background-color: grey;
	}
</style>
  </body>
</html>
